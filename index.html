<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Proxy Demo — School IT Project</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root { --accent:#0b74de; --muted:#666; }
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial; margin:0; padding:18px; background:#f7f9fc; }
    header { display:flex; align-items:center; gap:12px; margin-bottom:12px; }
    h1 { font-size:18px; margin:0; }
    .controls { display:flex; gap:8px; align-items:center; width:100%; }
    input[type="text"] { flex:1; padding:10px 12px; font-size:14px; border:1px solid #ccd; border-radius:6px; }
    button { background:var(--accent); color:#fff; border:none; padding:9px 12px; border-radius:6px; cursor:pointer; }
    button.secondary { background:#fff; color:var(--accent); border:1px solid #cfe; }
    .frame-wrap { margin-top:12px; width:100%; height:76vh; border:1px solid #dce; border-radius:6px; overflow:hidden; }
    iframe { width:100%; height:100%; border:0; display:block; background:white; }
    .meta { margin-top:8px; color:var(--muted); font-size:13px; }
    .note { color:#b04; font-size:12px; margin-left:6px; }
    .small { font-size:12px; color:#888; }
  </style>
</head>
<body>
  <header>
    <h1>School Proxy — Project Demo</h1>
  </header>

  <form id="form" class="controls" onsubmit="return false;">
    <input id="url" type="text" placeholder="Enter URL (e.g. https://www.google.com)"/>
    <button id="go">Go</button>
    <button id="openNew" class="secondary" title="Open proxied URL in new tab">Open</button>
  </form>

  <div class="meta small">Tip: use full URL (include https://). For WebSocket games, use the Join WebSocket button (if provided by your instructor).</div>

  <div class="frame-wrap">
    <iframe id="frame" sandbox="allow-scripts allow-forms allow-same-origin"></iframe>
  </div>

  <script>
    const input = document.getElementById('url');
    const go = document.getElementById('go');
    const openNew = document.getElementById('openNew');
    const frame = document.getElementById('frame');

    function proxify(u) {
      return '/proxy?url=' + encodeURIComponent(u);
    }

    function validUrl(s) {
      try {
        new URL(s);
        return true;
      } catch (e) {
        return false;
      }
    }

    go.addEventListener('click', () => {
      const v = input.value.trim();
      if (!v) return alert('Enter a URL');
      const urlStr = validUrl(v) ? v : ('https://' + v);
      frame.src = proxify(urlStr);
    });

    openNew.addEventListener('click', () => {
      const v = input.value.trim();
      if (!v) return alert('Enter a URL');
      const urlStr = validUrl(v) ? v : ('https://' + v);
      // Open proxied URL in a new tab (so teacher can inspect network)
      window.open(proxify(urlStr), '_blank');
    });

    // quick keyboard: Enter runs Go
    input.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') { e.preventDefault(); go.click(); }
    });

    // small convenience: example URL prefill
    input.value = 'https://www.google.com';
    // auto-load on open
    window.addEventListener('load', () => { setTimeout(() => go.click(), 200); });

    // warn before leaving (user preference in your project guidelines)
    window.onbeforeunload = function() {
      return "Leaving will stop any active sessions";
    };
  </script>
</body>
</html>
